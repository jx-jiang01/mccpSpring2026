<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>UpANNS Architecture Diagram</title>
<link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&family=Times+New+Roman&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #ffffff;
    --text: #1a1a1a;
    --caption: #1a1a1a;
  }
  html.dark {
    --bg: #1e1e2e;
    --text: #e0e0e0;
    --caption: #d0d0d0;
  }
  * { margin: 0; padding: 0; box-sizing: border-box; }
  body {
    background: var(--bg);
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    padding: 10px;
    font-family: 'Source Sans Pro', 'Times New Roman', serif;
  }
  .container {
    width: 100%;
    max-width: 1300px;
    overflow-x: auto;
  }
  svg text {
    font-family: 'Source Sans Pro', 'Times New Roman', serif;
  }
  .caption {
    text-align: center;
    color: var(--caption);
    font-family: 'Times New Roman', serif;
    font-size: 15px;
    margin-top: 4px;
    padding: 0 10px;
  }
</style>
</head>
<body>
<div class="container">
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1300 560" width="100%">
  <defs>
    <marker id="arrowBlack" markerWidth="8" markerHeight="6" refX="8" refY="3" orient="auto">
      <path d="M0,0 L8,3 L0,6 Z" fill="#444"/>
    </marker>
    <marker id="arrowBlackSmall" markerWidth="6" markerHeight="5" refX="6" refY="2.5" orient="auto">
      <path d="M0,0 L6,2.5 L0,5 Z" fill="#444"/>
    </marker>
    <!-- Blue box background gradient -->
    <linearGradient id="blueBoxBg" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#d6e8f7"/>
      <stop offset="100%" stop-color="#c4ddf0"/>
    </linearGradient>
    <linearGradient id="blueBoxBg2" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#d0e4f4"/>
      <stop offset="100%" stop-color="#bdd8ee"/>
    </linearGradient>
    <!-- DPU chip icon -->
    <symbol id="dpuChip" viewBox="0 0 36 36">
      <rect x="8" y="8" width="20" height="20" rx="2" fill="#2a6496" stroke="#1a4a72" stroke-width="1"/>
      <rect x="12" y="12" width="12" height="12" rx="1" fill="#3a7ab8"/>
      <!-- pins -->
      <line x1="12" y1="8" x2="12" y2="3" stroke="#1a4a72" stroke-width="1.5"/>
      <line x1="18" y1="8" x2="18" y2="3" stroke="#1a4a72" stroke-width="1.5"/>
      <line x1="24" y1="8" x2="24" y2="3" stroke="#1a4a72" stroke-width="1.5"/>
      <line x1="12" y1="28" x2="12" y2="33" stroke="#1a4a72" stroke-width="1.5"/>
      <line x1="18" y1="28" x2="18" y2="33" stroke="#1a4a72" stroke-width="1.5"/>
      <line x1="24" y1="28" x2="24" y2="33" stroke="#1a4a72" stroke-width="1.5"/>
      <line x1="8" y1="12" x2="3" y2="12" stroke="#1a4a72" stroke-width="1.5"/>
      <line x1="8" y1="18" x2="3" y2="18" stroke="#1a4a72" stroke-width="1.5"/>
      <line x1="8" y1="24" x2="3" y2="24" stroke="#1a4a72" stroke-width="1.5"/>
      <line x1="28" y1="12" x2="33" y2="12" stroke="#1a4a72" stroke-width="1.5"/>
      <line x1="28" y1="18" x2="33" y2="18" stroke="#1a4a72" stroke-width="1.5"/>
      <line x1="28" y1="24" x2="33" y2="24" stroke="#1a4a72" stroke-width="1.5"/>
    </symbol>
    <!-- Database cylinder -->
    <symbol id="dbCylinder" viewBox="0 0 24 30">
      <ellipse cx="12" cy="6" rx="10" ry="5" fill="currentColor" stroke="#555" stroke-width="0.7"/>
      <rect x="2" y="6" width="20" height="18" fill="currentColor"/>
      <ellipse cx="12" cy="24" rx="10" ry="5" fill="currentColor" stroke="#555" stroke-width="0.7"/>
      <line x1="2" y1="6" x2="2" y2="24" stroke="#555" stroke-width="0.7"/>
      <line x1="22" y1="6" x2="22" y2="24" stroke="#555" stroke-width="0.7"/>
      <ellipse cx="12" cy="6" rx="10" ry="5" fill="none" stroke="#555" stroke-width="0.7"/>
    </symbol>
  </defs>

  <!-- ==================== OFFLINE SECTION (TOP) ==================== -->

  <!-- Encoded Points -->
  <text x="72" y="25" font-size="14" font-weight="700" text-anchor="middle" fill="#1a1a1a">Encoded points</text>

  <!-- Vector labels and grids -->
  <!-- Vector 0 -->
  <text x="18" y="50" font-size="11.5" font-style="italic" fill="#333">Vector 0</text>
  <!-- 8 colored squares for Vector 0 -->
  <g transform="translate(75, 36)">
    <rect x="0" y="0" width="12" height="12" fill="#8fc48a" stroke="#aaa" stroke-width="0.5"/>
    <rect x="13" y="0" width="12" height="12" fill="#e8c98a" stroke="#aaa" stroke-width="0.5"/>
    <rect x="26" y="0" width="12" height="12" fill="#bbb" stroke="#aaa" stroke-width="0.5"/>
    <rect x="39" y="0" width="12" height="12" fill="#8fc48a" stroke="#aaa" stroke-width="0.5"/>
    <rect x="52" y="0" width="12" height="12" fill="#bbb" stroke="#aaa" stroke-width="0.5"/>
    <rect x="65" y="0" width="12" height="12" fill="#e8c98a" stroke="#aaa" stroke-width="0.5"/>
    <rect x="78" y="0" width="12" height="12" fill="#8fc48a" stroke="#aaa" stroke-width="0.5"/>
    <rect x="91" y="0" width="12" height="12" fill="#e8c98a" stroke="#aaa" stroke-width="0.5"/>
  </g>

  <!-- Vector 1 -->
  <text x="18" y="67" font-size="11.5" font-style="italic" fill="#333">Vector 1</text>
  <g transform="translate(75, 53)">
    <rect x="0" y="0" width="12" height="12" fill="#e8c98a" stroke="#aaa" stroke-width="0.5"/>
    <rect x="13" y="0" width="12" height="12" fill="#bbb" stroke="#aaa" stroke-width="0.5"/>
    <rect x="26" y="0" width="12" height="12" fill="#8fc48a" stroke="#aaa" stroke-width="0.5"/>
    <rect x="39" y="0" width="12" height="12" fill="#bbb" stroke="#aaa" stroke-width="0.5"/>
    <rect x="52" y="0" width="12" height="12" fill="#e8c98a" stroke="#aaa" stroke-width="0.5"/>
    <rect x="65" y="0" width="12" height="12" fill="#8fc48a" stroke="#aaa" stroke-width="0.5"/>
    <rect x="78" y="0" width="12" height="12" fill="#bbb" stroke="#aaa" stroke-width="0.5"/>
    <rect x="91" y="0" width="12" height="12" fill="#e8c98a" stroke="#aaa" stroke-width="0.5"/>
  </g>

  <!-- Vector 2 -->
  <text x="18" y="84" font-size="11.5" font-style="italic" fill="#333">Vector 2</text>
  <g transform="translate(75, 70)">
    <rect x="0" y="0" width="12" height="12" fill="#bbb" stroke="#aaa" stroke-width="0.5"/>
    <rect x="13" y="0" width="12" height="12" fill="#8fc48a" stroke="#aaa" stroke-width="0.5"/>
    <rect x="26" y="0" width="12" height="12" fill="#e8c98a" stroke="#aaa" stroke-width="0.5"/>
    <rect x="39" y="0" width="12" height="12" fill="#8fc48a" stroke="#aaa" stroke-width="0.5"/>
    <rect x="52" y="0" width="12" height="12" fill="#bbb" stroke="#aaa" stroke-width="0.5"/>
    <rect x="65" y="0" width="12" height="12" fill="#bbb" stroke="#aaa" stroke-width="0.5"/>
    <rect x="78" y="0" width="12" height="12" fill="#e8c98a" stroke="#aaa" stroke-width="0.5"/>
    <rect x="91" y="0" width="12" height="12" fill="#8fc48a" stroke="#aaa" stroke-width="0.5"/>
  </g>

  <!-- Dots (...) -->
  <text x="100" y="103" font-size="18" font-weight="700" fill="#333" text-anchor="middle">⋮</text>

  <!-- Vector n -->
  <text x="18" y="127" font-size="11.5" font-style="italic" fill="#333">Vector n</text>
  <g transform="translate(75, 113)">
    <rect x="0" y="0" width="12" height="12" fill="#8fc48a" stroke="#aaa" stroke-width="0.5"/>
    <rect x="13" y="0" width="12" height="12" fill="#8fc48a" stroke="#aaa" stroke-width="0.5"/>
    <rect x="26" y="0" width="12" height="12" fill="#bbb" stroke="#aaa" stroke-width="0.5"/>
    <rect x="39" y="0" width="12" height="12" fill="#e8c98a" stroke="#aaa" stroke-width="0.5"/>
    <rect x="52" y="0" width="12" height="12" fill="#8fc48a" stroke="#aaa" stroke-width="0.5"/>
    <rect x="65" y="0" width="12" height="12" fill="#bbb" stroke="#aaa" stroke-width="0.5"/>
    <rect x="78" y="0" width="12" height="12" fill="#e8c98a" stroke="#aaa" stroke-width="0.5"/>
    <rect x="91" y="0" width="12" height="12" fill="#8fc48a" stroke="#aaa" stroke-width="0.5"/>
  </g>

  <!-- Arrow from encoded points to co-occurrence box -->
  <line x1="182" y1="80" x2="230" y2="80" stroke="#888" stroke-width="8" marker-end="url(#arrowBlack)"/>
  <line x1="182" y1="80" x2="225" y2="80" stroke="#bbb" stroke-width="6"/>
  <!-- Gray thick arrow -->
  <polygon points="182,72 222,72 222,66 236,80 222,94 222,88 182,88" fill="#bbb" stroke="#999" stroke-width="0.5"/>

  <!-- ==================== Co-occurrence Aware Encoding Box ==================== -->
  <rect x="245" y="8" width="380" height="210" rx="6" fill="url(#blueBoxBg)" stroke="#7badd4" stroke-width="1.5"/>
  <text x="435" y="228" font-size="13" font-weight="600" text-anchor="middle" fill="#1a1a1a">Co-occurrence Aware Encoding</text>

  <!-- "High Frequent Co-occurrence" label box -->
  <rect x="320" y="16" width="160" height="32" rx="4" fill="#4a90b8" opacity="0.85"/>
  <text x="400" y="30" font-size="11" font-weight="600" text-anchor="middle" fill="white">High Frequent</text>
  <text x="400" y="43" font-size="11" font-weight="600" text-anchor="middle" fill="white">Co-occurrence</text>

  <!-- Left grid (larger, with grey highlights) -->
  <g transform="translate(270, 55)">
    <!-- Row 0 -->
    <rect x="0" y="0" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="15" y="0" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="30" y="0" width="14" height="14" fill="#e8c98a" stroke="#bbb" stroke-width="0.5"/>
    <rect x="45" y="0" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="60" y="0" width="14" height="14" fill="#8fc48a" stroke="#bbb" stroke-width="0.5"/>
    <rect x="75" y="0" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="90" y="0" width="14" height="14" fill="#e8c98a" stroke="#bbb" stroke-width="0.5"/>
    <rect x="105" y="0" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <!-- Row 1 -->
    <rect x="0" y="15" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="15" y="15" width="14" height="14" fill="#8fc48a" stroke="#bbb" stroke-width="0.5"/>
    <rect x="30" y="15" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="45" y="15" width="14" height="14" fill="#bbb" stroke="#999" stroke-width="0.5"/>
    <rect x="60" y="15" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="75" y="15" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="90" y="15" width="14" height="14" fill="#8fc48a" stroke="#bbb" stroke-width="0.5"/>
    <rect x="105" y="15" width="14" height="14" fill="#e8c98a" stroke="#bbb" stroke-width="0.5"/>
    <!-- Row 2 -->
    <rect x="0" y="30" width="14" height="14" fill="#e8c98a" stroke="#bbb" stroke-width="0.5"/>
    <rect x="15" y="30" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="30" y="30" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="45" y="30" width="14" height="14" fill="#8fc48a" stroke="#bbb" stroke-width="0.5"/>
    <rect x="60" y="30" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="75" y="30" width="14" height="14" fill="#e8c98a" stroke="#bbb" stroke-width="0.5"/>
    <rect x="90" y="30" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="105" y="30" width="14" height="14" fill="#bbb" stroke="#999" stroke-width="0.5"/>
    <!-- Row 3 -->
    <rect x="0" y="45" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="15" y="45" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="30" y="45" width="14" height="14" fill="#8fc48a" stroke="#bbb" stroke-width="0.5"/>
    <rect x="45" y="45" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="60" y="45" width="14" height="14" fill="#e8c98a" stroke="#bbb" stroke-width="0.5"/>
    <rect x="75" y="45" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="90" y="45" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="105" y="45" width="14" height="14" fill="#8fc48a" stroke="#bbb" stroke-width="0.5"/>
    <!-- Row 4 -->
    <rect x="0" y="60" width="14" height="14" fill="#bbb" stroke="#999" stroke-width="0.5"/>
    <rect x="15" y="60" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="30" y="60" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="45" y="60" width="14" height="14" fill="#e8c98a" stroke="#bbb" stroke-width="0.5"/>
    <rect x="60" y="60" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="75" y="60" width="14" height="14" fill="#bbb" stroke="#999" stroke-width="0.5"/>
    <rect x="90" y="60" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="105" y="60" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <!-- Row 5 -->
    <rect x="0" y="75" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="15" y="75" width="14" height="14" fill="#e8c98a" stroke="#bbb" stroke-width="0.5"/>
    <rect x="30" y="75" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="45" y="75" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="60" y="75" width="14" height="14" fill="#8fc48a" stroke="#bbb" stroke-width="0.5"/>
    <rect x="75" y="75" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="90" y="75" width="14" height="14" fill="#e8c98a" stroke="#bbb" stroke-width="0.5"/>
    <rect x="105" y="75" width="14" height="14" fill="#8fc48a" stroke="#bbb" stroke-width="0.5"/>
  </g>

  <!-- "Encode" label -->
  <text x="420" y="130" font-size="13" font-weight="600" fill="#1a1a1a">Encode</text>

  <!-- Arrow lines from grid to encoded blocks -->
  <line x1="395" y1="100" x2="460" y2="65" stroke="#888" stroke-width="1.2" marker-end="url(#arrowBlackSmall)"/>
  <line x1="395" y1="120" x2="460" y2="100" stroke="#888" stroke-width="1.2" marker-end="url(#arrowBlackSmall)"/>
  <line x1="395" y1="140" x2="460" y2="135" stroke="#888" stroke-width="1.2" marker-end="url(#arrowBlackSmall)"/>
  <line x1="395" y1="160" x2="460" y2="165" stroke="#888" stroke-width="1.2" marker-end="url(#arrowBlackSmall)"/>
  <line x1="395" y1="175" x2="460" y2="195" stroke="#888" stroke-width="1.2" marker-end="url(#arrowBlackSmall)"/>

  <!-- Encoded smaller blocks (right side of encoding box) -->
  <!-- Block group 1 - top -->
  <g transform="translate(465, 50)">
    <rect x="0" y="0" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="16" y="0" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="32" y="0" width="14" height="14" fill="#e8c98a" stroke="#bbb" stroke-width="0.5"/>
    <rect x="48" y="0" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
  </g>
  <!-- Block group 2 -->
  <g transform="translate(465, 85)">
    <rect x="0" y="0" width="14" height="14" fill="#8fc48a" stroke="#bbb" stroke-width="0.5"/>
    <rect x="16" y="0" width="14" height="14" fill="#2d6b2d" stroke="#bbb" stroke-width="0.5"/>
    <rect x="32" y="0" width="14" height="14" fill="#8fc48a" stroke="#bbb" stroke-width="0.5"/>
    <rect x="48" y="0" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
  </g>
  <!-- Block group 3 -->
  <g transform="translate(465, 120)">
    <rect x="0" y="0" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="16" y="0" width="14" height="14" fill="#e8a050" stroke="#bbb" stroke-width="0.5"/>
    <rect x="32" y="0" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
  </g>
  <!-- Block group 4 -->
  <g transform="translate(465, 155)">
    <rect x="0" y="0" width="14" height="14" fill="#bbb" stroke="#999" stroke-width="0.5"/>
    <rect x="16" y="0" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
  </g>
  <!-- Block group 5 -->
  <g transform="translate(465, 185)">
    <rect x="0" y="0" width="14" height="14" fill="#e8c98a" stroke="#bbb" stroke-width="0.5"/>
  </g>

  <!-- Converging arrows from encoded blocks to right -->
  <line x1="535" y1="65" x2="570" y2="100" stroke="#888" stroke-width="1.2" marker-end="url(#arrowBlackSmall)"/>
  <line x1="535" y1="95" x2="570" y2="105" stroke="#888" stroke-width="1.2" marker-end="url(#arrowBlackSmall)"/>
  <line x1="530" y1="130" x2="570" y2="115" stroke="#888" stroke-width="1.2" marker-end="url(#arrowBlackSmall)"/>
  <line x1="520" y1="165" x2="570" y2="130" stroke="#888" stroke-width="1.2" marker-end="url(#arrowBlackSmall)"/>
  <line x1="510" y1="195" x2="570" y2="140" stroke="#888" stroke-width="1.2" marker-end="url(#arrowBlackSmall)"/>

  <!-- Merged encoded result block -->
  <g transform="translate(575, 80)">
    <rect x="0" y="0" width="14" height="14" fill="#ddd" stroke="#bbb" stroke-width="0.5"/>
    <rect x="0" y="15" width="14" height="14" fill="#8fc48a" stroke="#bbb" stroke-width="0.5"/>
    <rect x="0" y="30" width="14" height="14" fill="#2d6b2d" stroke="#bbb" stroke-width="0.5"/>
    <rect x="0" y="45" width="14" height="14" fill="#e8a050" stroke="#bbb" stroke-width="0.5"/>
    <rect x="0" y="60" width="14" height="14" fill="#bbb" stroke="#999" stroke-width="0.5"/>
    <rect x="0" y="75" width="14" height="14" fill="#e8c98a" stroke="#bbb" stroke-width="0.5"/>
  </g>

  <!-- ==================== Arrow between encoding and distribution ==================== -->
  <polygon points="630,104 670,104 670,98 684,112 670,126 670,120 630,120" fill="#bbb" stroke="#999" stroke-width="0.5"/>

  <!-- ==================== Copy & Distribute Box ==================== -->
  <rect x="695" y="8" width="580" height="210" rx="6" fill="url(#blueBoxBg)" stroke="#7badd4" stroke-width="1.5"/>
  <text x="985" y="28" font-size="14" font-weight="700" text-anchor="middle" fill="#1a5a8a">Copy &amp; Distribute</text>

  <!-- Database cylinders row -->
  <g transform="translate(720, 42)">
    <!-- Green cylinder 1 -->
    <g color="#6ab86a">
      <ellipse cx="18" cy="8" rx="14" ry="6" fill="#6ab86a" stroke="#4a8a4a" stroke-width="0.7"/>
      <rect x="4" y="8" width="28" height="20" fill="#6ab86a"/>
      <ellipse cx="18" cy="28" rx="14" ry="6" fill="#5aa85a" stroke="#4a8a4a" stroke-width="0.7"/>
      <line x1="4" y1="8" x2="4" y2="28" stroke="#4a8a4a" stroke-width="0.7"/>
      <line x1="32" y1="8" x2="32" y2="28" stroke="#4a8a4a" stroke-width="0.7"/>
      <ellipse cx="18" cy="8" rx="14" ry="6" fill="none" stroke="#4a8a4a" stroke-width="0.7"/>
    </g>
    <!-- Green cylinder 2 -->
    <g transform="translate(0, 30)" color="#6ab86a">
      <ellipse cx="18" cy="8" rx="14" ry="6" fill="#6ab86a" stroke="#4a8a4a" stroke-width="0.7"/>
      <rect x="4" y="8" width="28" height="20" fill="#6ab86a"/>
      <ellipse cx="18" cy="28" rx="14" ry="6" fill="#5aa85a" stroke="#4a8a4a" stroke-width="0.7"/>
      <line x1="4" y1="8" x2="4" y2="28" stroke="#4a8a4a" stroke-width="0.7"/>
      <line x1="32" y1="8" x2="32" y2="28" stroke="#4a8a4a" stroke-width="0.7"/>
    </g>
  </g>

  <!-- Orange cylinder stack -->
  <g transform="translate(775, 42)">
    <g>
      <ellipse cx="18" cy="8" rx="14" ry="6" fill="#e8a050" stroke="#c07830" stroke-width="0.7"/>
      <rect x="4" y="8" width="28" height="20" fill="#e8a050"/>
      <ellipse cx="18" cy="28" rx="14" ry="6" fill="#d89040" stroke="#c07830" stroke-width="0.7"/>
      <line x1="4" y1="8" x2="4" y2="28" stroke="#c07830" stroke-width="0.7"/>
      <line x1="32" y1="8" x2="32" y2="28" stroke="#c07830" stroke-width="0.7"/>
      <ellipse cx="18" cy="8" rx="14" ry="6" fill="none" stroke="#c07830" stroke-width="0.7"/>
    </g>
    <g transform="translate(0, 30)">
      <ellipse cx="18" cy="8" rx="14" ry="6" fill="#e8a050" stroke="#c07830" stroke-width="0.7"/>
      <rect x="4" y="8" width="28" height="20" fill="#e8a050"/>
      <ellipse cx="18" cy="28" rx="14" ry="6" fill="#d89040" stroke="#c07830" stroke-width="0.7"/>
      <line x1="4" y1="8" x2="4" y2="28" stroke="#c07830" stroke-width="0.7"/>
      <line x1="32" y1="8" x2="32" y2="28" stroke="#c07830" stroke-width="0.7"/>
    </g>
  </g>

  <!-- Yellow cylinder stack -->
  <g transform="translate(830, 42)">
    <g>
      <ellipse cx="18" cy="8" rx="14" ry="6" fill="#e8d86a" stroke="#b8a840" stroke-width="0.7"/>
      <rect x="4" y="8" width="28" height="20" fill="#e8d86a"/>
      <ellipse cx="18" cy="28" rx="14" ry="6" fill="#d8c860" stroke="#b8a840" stroke-width="0.7"/>
      <line x1="4" y1="8" x2="4" y2="28" stroke="#b8a840" stroke-width="0.7"/>
      <line x1="32" y1="8" x2="32" y2="28" stroke="#b8a840" stroke-width="0.7"/>
      <ellipse cx="18" cy="8" rx="14" ry="6" fill="none" stroke="#b8a840" stroke-width="0.7"/>
    </g>
    <g transform="translate(0, 30)">
      <ellipse cx="18" cy="8" rx="14" ry="6" fill="#e8d86a" stroke="#b8a840" stroke-width="0.7"/>
      <rect x="4" y="8" width="28" height="20" fill="#e8d86a"/>
      <ellipse cx="18" cy="28" rx="14" ry="6" fill="#d8c860" stroke="#b8a840" stroke-width="0.7"/>
      <line x1="4" y1="8" x2="4" y2="28" stroke="#b8a840" stroke-width="0.7"/>
      <line x1="32" y1="8" x2="32" y2="28" stroke="#b8a840" stroke-width="0.7"/>
    </g>
  </g>

  <!-- Dots -->
  <text x="890" y="80" font-size="22" font-weight="700" fill="#333">···</text>

  <!-- More cylinder stacks after dots -->
  <!-- Green again -->
  <g transform="translate(920, 42)">
    <g>
      <ellipse cx="18" cy="8" rx="14" ry="6" fill="#6ab86a" stroke="#4a8a4a" stroke-width="0.7"/>
      <rect x="4" y="8" width="28" height="20" fill="#6ab86a"/>
      <ellipse cx="18" cy="28" rx="14" ry="6" fill="#5aa85a" stroke="#4a8a4a" stroke-width="0.7"/>
      <line x1="4" y1="8" x2="4" y2="28" stroke="#4a8a4a" stroke-width="0.7"/>
      <line x1="32" y1="8" x2="32" y2="28" stroke="#4a8a4a" stroke-width="0.7"/>
      <ellipse cx="18" cy="8" rx="14" ry="6" fill="none" stroke="#4a8a4a" stroke-width="0.7"/>
    </g>
    <g transform="translate(0, 30)">
      <ellipse cx="18" cy="8" rx="14" ry="6" fill="#6ab86a" stroke="#4a8a4a" stroke-width="0.7"/>
      <rect x="4" y="8" width="28" height="20" fill="#6ab86a"/>
      <ellipse cx="18" cy="28" rx="14" ry="6" fill="#5aa85a" stroke="#4a8a4a" stroke-width="0.7"/>
      <line x1="4" y1="8" x2="4" y2="28" stroke="#4a8a4a" stroke-width="0.7"/>
      <line x1="32" y1="8" x2="32" y2="28" stroke="#4a8a4a" stroke-width="0.7"/>
    </g>
  </g>

  <!-- Yellow-green -->
  <g transform="translate(975, 42)">
    <g>
      <ellipse cx="18" cy="8" rx="14" ry="6" fill="#a8d868" stroke="#7aaa48" stroke-width="0.7"/>
      <rect x="4" y="8" width="28" height="20" fill="#a8d868"/>
      <ellipse cx="18" cy="28" rx="14" ry="6" fill="#98c858" stroke="#7aaa48" stroke-width="0.7"/>
      <line x1="4" y1="8" x2="4" y2="28" stroke="#7aaa48" stroke-width="0.7"/>
      <line x1="32" y1="8" x2="32" y2="28" stroke="#7aaa48" stroke-width="0.7"/>
      <ellipse cx="18" cy="8" rx="14" ry="6" fill="none" stroke="#7aaa48" stroke-width="0.7"/>
    </g>
    <g transform="translate(0, 30)">
      <ellipse cx="18" cy="8" rx="14" ry="6" fill="#a8d868" stroke="#7aaa48" stroke-width="0.7"/>
      <rect x="4" y="8" width="28" height="20" fill="#a8d868"/>
      <ellipse cx="18" cy="28" rx="14" ry="6" fill="#98c858" stroke="#7aaa48" stroke-width="0.7"/>
      <line x1="4" y1="8" x2="4" y2="28" stroke="#7aaa48" stroke-width="0.7"/>
      <line x1="32" y1="8" x2="32" y2="28" stroke="#7aaa48" stroke-width="0.7"/>
    </g>
  </g>

  <!-- Data Transfer label -->
  <text x="985" y="155" font-size="14" font-weight="700" text-anchor="middle" fill="#1a5a8a">Data Transfer</text>

  <!-- Down arrows from cylinders to DPU chips -->
  <line x1="738" y1="108" x2="738" y2="130" stroke="#666" stroke-width="1" marker-end="url(#arrowBlackSmall)"/>
  <line x1="793" y1="108" x2="793" y2="130" stroke="#666" stroke-width="1" marker-end="url(#arrowBlackSmall)"/>
  <line x1="848" y1="108" x2="848" y2="130" stroke="#666" stroke-width="1" marker-end="url(#arrowBlackSmall)"/>
  <line x1="938" y1="108" x2="938" y2="130" stroke="#666" stroke-width="1" marker-end="url(#arrowBlackSmall)"/>
  <line x1="993" y1="108" x2="993" y2="130" stroke="#666" stroke-width="1" marker-end="url(#arrowBlackSmall)"/>

  <!-- DPU chip icons -->
  <use href="#dpuChip" x="720" y="132" width="36" height="36"/>
  <use href="#dpuChip" x="775" y="132" width="36" height="36"/>
  <use href="#dpuChip" x="830" y="132" width="36" height="36"/>

  <!-- Dots between chips -->
  <text x="885" y="155" font-size="16" font-weight="700" fill="#333">···</text>

  <use href="#dpuChip" x="920" y="132" width="36" height="36"/>
  <use href="#dpuChip" x="975" y="132" width="36" height="36"/>

  <!-- DPU labels -->
  <text x="738" y="182" font-size="10" text-anchor="middle" fill="#333">DPU 0</text>
  <text x="793" y="182" font-size="10" text-anchor="middle" fill="#333">DPU 1</text>
  <text x="848" y="182" font-size="10" text-anchor="middle" fill="#333">DPU 2</text>
  <text x="938" y="182" font-size="10" text-anchor="middle" fill="#333">DPU 0</text>
  <text x="993" y="182" font-size="10" text-anchor="middle" fill="#333">DPU n</text>

  <!-- ==================== Offline / Online Divider ==================== -->
  <line x1="0" y1="270" x2="1300" y2="270" stroke="#666" stroke-width="1.5" stroke-dasharray="8,5"/>

  <!-- Offline label -->
  <text x="15" y="262" font-size="18" font-weight="700" font-style="italic" fill="#c0392b">Offline</text>
  <!-- Online label -->
  <text x="15" y="286" font-size="18" font-weight="700" font-style="italic" fill="#c0392b">Online</text>

  <!-- ==================== ONLINE SECTION (BOTTOM) ==================== -->

  <!-- CPU Box -->
  <rect x="30" y="305" width="285" height="195" rx="6" fill="#eee" stroke="#ccc" stroke-width="1.5" opacity="0.6"/>
  <text x="50" y="322" font-size="14" font-weight="700" fill="#333">CPU</text>

  <!-- Query Batch box -->
  <rect x="50" y="430" width="72" height="42" rx="4" fill="white" stroke="#666" stroke-width="1"/>
  <text x="86" y="448" font-size="10.5" font-weight="600" text-anchor="middle" fill="#333">Query</text>
  <text x="86" y="461" font-size="10.5" font-weight="600" text-anchor="middle" fill="#333">Batch</text>

  <!-- Arrow from Query Batch to Cluster Filtering -->
  <line x1="122" y1="451" x2="148" y2="451" stroke="#444" stroke-width="1.2" marker-end="url(#arrowBlackSmall)"/>

  <!-- ①Cluster Filtering box -->
  <rect x="152" y="425" width="100" height="50" rx="4" fill="#d6e8f7" stroke="#7badd4" stroke-width="1.2"/>
  <text x="202" y="447" font-size="11" font-weight="700" text-anchor="middle" fill="#1a5a8a">①Cluster</text>
  <text x="202" y="461" font-size="11" font-weight="700" text-anchor="middle" fill="#1a5a8a">Filtering</text>

  <!-- Arrow from Cluster Filtering up to Query Scheduling -->
  <line x1="202" y1="425" x2="202" y2="385" stroke="#444" stroke-width="1.2" marker-end="url(#arrowBlackSmall)"/>

  <!-- ②Query Scheduling box -->
  <rect x="152" y="335" width="100" height="48" rx="4" fill="#d6e8f7" stroke="#7badd4" stroke-width="1.2"/>
  <text x="202" y="355" font-size="11" font-weight="700" text-anchor="middle" fill="#1a5a8a">②Query</text>
  <text x="202" y="369" font-size="11" font-weight="700" text-anchor="middle" fill="#1a5a8a">Scheduling</text>

  <!-- Arrow from Query Scheduling to right (toward DPU) -->
  <line x1="252" y1="359" x2="310" y2="359" stroke="#444" stroke-width="1.2" marker-end="url(#arrowBlackSmall)"/>

  <!-- Vertical dots indicating multiple DPUs -->
  <text x="328" y="400" font-size="20" font-weight="700" fill="#333">⋮</text>

  <!-- Multiple arrow lines going to DPU box -->
  <line x1="310" y1="359" x2="340" y2="340" stroke="#444" stroke-width="1.2" marker-end="url(#arrowBlackSmall)"/>
  <line x1="310" y1="359" x2="340" y2="359" stroke="#444" stroke-width="1.2"/>
  <line x1="335" y1="359" x2="375" y2="359" stroke="#444" stroke-width="1.2" marker-end="url(#arrowBlackSmall)"/>

  <!-- DPU × n label -->
  <text x="335" y="485" font-size="12" font-weight="600" fill="#333">DPU × n</text>

  <!-- Arrow lines fanning down -->
  <line x1="310" y1="359" x2="340" y2="420" stroke="#444" stroke-width="1.2"/>
  <line x1="340" y1="420" x2="340" y2="470" stroke="#444" stroke-width="1.2" marker-end="url(#arrowBlackSmall)"/>

  <!-- ==================== DPU Processing Box ==================== -->
  <rect x="380" y="300" width="895" height="220" rx="6" fill="url(#blueBoxBg2)" stroke="#7badd4" stroke-width="1.5"/>
  <text x="400" y="318" font-size="14" font-weight="700" fill="#1a5a8a">DPU</text>

  <!-- Inner pipeline boxes -->
  <!-- ③LUT Construction -->
  <rect x="410" y="330" width="135" height="52" rx="4" fill="white" stroke="#7badd4" stroke-width="1.2"/>
  <text x="477" y="352" font-size="12" font-weight="700" text-anchor="middle" fill="#1a5a8a">③LUT</text>
  <text x="477" y="368" font-size="12" font-weight="700" text-anchor="middle" fill="#1a5a8a">Construction</text>

  <!-- Arrow -->
  <line x1="545" y1="356" x2="570" y2="356" stroke="#444" stroke-width="1.2" marker-end="url(#arrowBlackSmall)"/>

  <!-- ④Distance Calculation -->
  <rect x="575" y="330" width="145" height="52" rx="4" fill="white" stroke="#7badd4" stroke-width="1.2"/>
  <text x="647" y="352" font-size="12" font-weight="700" text-anchor="middle" fill="#1a5a8a">④Distance</text>
  <text x="647" y="368" font-size="12" font-weight="700" text-anchor="middle" fill="#1a5a8a">Calculation</text>

  <!-- Arrow -->
  <line x1="720" y1="356" x2="750" y2="356" stroke="#444" stroke-width="1.2" marker-end="url(#arrowBlackSmall)"/>

  <!-- ⑤TOP-K Pruning -->
  <rect x="755" y="330" width="135" height="52" rx="4" fill="white" stroke="#7badd4" stroke-width="1.2"/>
  <text x="822" y="352" font-size="12" font-weight="700" text-anchor="middle" fill="#1a5a8a">⑤TOP-K</text>
  <text x="822" y="368" font-size="12" font-weight="700" text-anchor="middle" fill="#1a5a8a">Pruning</text>

  <!-- Arrow -->
  <line x1="890" y1="356" x2="925" y2="356" stroke="#444" stroke-width="1.2" marker-end="url(#arrowBlackSmall)"/>

  <!-- ⑥Identifying Top-k -->
  <rect x="930" y="330" width="145" height="52" rx="4" fill="white" stroke="#7badd4" stroke-width="1.2"/>
  <text x="1002" y="352" font-size="12" font-weight="700" text-anchor="middle" fill="#1a5a8a">⑥Identifying</text>
  <text x="1002" y="368" font-size="12" font-weight="700" text-anchor="middle" fill="#1a5a8a">Top-k</text>

  <!-- "Control" label in red -->
  <text x="760" y="405" font-size="13" font-weight="600" font-style="italic" fill="#c0392b">Control</text>

  <!-- Double-headed arrows from pipeline to resource management -->
  <line x1="647" y1="382" x2="647" y2="430" stroke="#444" stroke-width="1.2" marker-end="url(#arrowBlackSmall)"/>
  <line x1="647" y1="432" x2="647" y2="384" stroke="#444" stroke-width="1.2" marker-end="url(#arrowBlackSmall)"/>

  <line x1="822" y1="382" x2="822" y2="430" stroke="#444" stroke-width="1.2" marker-end="url(#arrowBlackSmall)"/>
  <line x1="822" y1="432" x2="822" y2="384" stroke="#444" stroke-width="1.2" marker-end="url(#arrowBlackSmall)"/>

  <!-- Efficient Resource Management box -->
  <rect x="490" y="430" width="475" height="75" rx="5" fill="#d6e8f7" stroke="#7badd4" stroke-width="1.2"/>
  <text x="727" y="497" font-size="13" font-weight="700" text-anchor="middle" fill="#1a5a8a">Efficient Resource Management</text>

  <!-- Thread Scheduling sub-box -->
  <rect x="520" y="440" width="185" height="38" rx="4" fill="white" stroke="#7badd4" stroke-width="1"/>
  <text x="612" y="464" font-size="12" font-weight="600" text-anchor="middle" fill="#1a5a8a">Thread Scheduling</text>

  <!-- Memory Management sub-box -->
  <rect x="740" y="440" width="195" height="38" rx="4" fill="white" stroke="#7badd4" stroke-width="1"/>
  <text x="837" y="464" font-size="12" font-weight="600" text-anchor="middle" fill="#1a5a8a">Memory Management</text>

  <!-- ==================== Caption ==================== -->
  <text x="650" y="545" font-size="15" font-weight="400" text-anchor="middle" fill="#1a1a1a" font-family="'Times New Roman', serif">
    Figure 5: Overview of UpANNS. The grey blocks in each vector represent high frequency co-occurrences in the encoded vectors.
  </text>

</svg>
</div>

<script>
  // Dark mode detection
  if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
    document.documentElement.classList.add('dark');
  }
  window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', function(event) {
    if (event.matches) {
      document.documentElement.classList.add('dark');
    } else {
      document.documentElement.classList.remove('dark');
    }
  });
</script>
</body>
</html>

